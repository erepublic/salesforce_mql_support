<?xml version="1.0" encoding="UTF-8" ?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>64.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Assign_Date_Closed</name>
        <label>Assign Date Closed</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>var_Date_Closed</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >f_Date_Closed_or_Current_Date</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Which_Record_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Ticket_to_Create_CommDev</name>
        <label>Assign Ticket to Create (CommDev)</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Account__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Agency_Function__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Agency_Function__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Assignee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Assignee__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Branch_of_Government__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >$Record.Branch_of_Government__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Brand__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Brand__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Campaign__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Campaign__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Contact_Pull_Contact_Count__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >$Record.Contact_Pull_Contact_Count__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Contact_Source__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Contact_Source__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Description__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Description__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Distribute_To__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Distribute_To__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Due_Date_Requested__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >f_Due_Date_by_Frequency_CommDev</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Education_Job_Function__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >$Record.Education_Job_Function__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Event__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Event__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Frequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Frequency__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Job_Function__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Job_Function__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Job_Role__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Job_Role__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Mailing_City_Radius__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >$Record.Mailing_City_Radius__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Mailing_City__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Mailing_City__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Mailing_State__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Mailing_State__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Paper__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Paper__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Phase__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Unassigned</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Priority__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Priority__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Product_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Product_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Project__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Project__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Promotion_Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Promotion_Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Quantity_Needed__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Quantity_Needed__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Requested_By__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Requested_By__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Title__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Title__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Department__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Department__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Ticket</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Ticket_to_Create_Salesforce</name>
        <label>Assign Ticket to Create (Salesforce)</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Account__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Assignee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Assignee__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Type__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Type__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Description__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Description__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Due_Date_Requested__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >f_Due_Date_by_Frequency_Salesforce</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Frequency__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Frequency__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Phase__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Unassigned</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Priority__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Priority__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.RecordTypeId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.RecordTypeId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Requested_By__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Requested_By__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Active</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_Ticket_to_Create.Title__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_Title_Salesforce</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Department__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Department__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Working_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >f_Due_Date_by_Frequency_Salesforce</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Estimated_Hours_to_Complete__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference
        >$Record.Estimated_Hours_to_Complete__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference
      >var_Ticket_to_Create.Created_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Ticket</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Which_Record_Type</name>
        <label>Which Record Type?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Create_Ticket</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>CommDev</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Community Development</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Audience Operations</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference
        >Assign_Ticket_to_Create_CommDev</targetReference>
            </connector>
            <label>CommDev</label>
        </rules>
        <rules>
            <name>Salesforce</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Salesforce</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference
        >Assign_Ticket_to_Create_Salesforce</targetReference>
            </connector>
            <label>Salesforce</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>f_Date_Closed_or_Current_Date</name>
        <dataType>Date</dataType>
        <expression
    >IF(ISBLANK({!$Record.Date_Closed__c}), {!$Flow.CurrentDate}, {!$Record.Date_Closed__c})</expression>
    </formulas>
    <formulas>
        <name>f_Due_Date_by_Frequency_CommDev</name>
        <dataType>Date</dataType>
        <expression>CASE(TEXT({!$Record.Frequency__c}), 
          &quot;Weekly&quot;, {!var_Date_Closed} +7,
          &quot;Biweekly&quot;, {!var_Date_Closed} +14,
           &quot;Monthly&quot;, {!var_Date_Closed} +30,
           &quot;Quarterly&quot;, {!var_Date_Closed}  +91,
          &quot;Biannual&quot;, {!var_Date_Closed}  +182,
          &quot;Annual&quot;, {!var_Date_Closed}  +365,
          {!var_Date_Closed}+1)</expression>
    </formulas>
    <formulas>
        <name>f_Due_Date_by_Frequency_Salesforce</name>
        <dataType>Date</dataType>
        <expression>IF(TEXT({!$Record.Type__c})=&quot;Weekly SF Export&quot;, 
    {!var_Date_Closed} + MOD(3 - WEEKDAY({!var_Date_Closed}) + 6, 7) + 1,
IF(CONTAINS({!$Record.Title__c},&quot;Salesforce Certificate Renewal&quot;), 
    {!var_Date_Closed}  +295,
CASE(TEXT({!$Record.Frequency__c}), 
          &quot;Weekly&quot;, {!var_Date_Closed} +7,
          &quot;Biweekly&quot;, {!var_Date_Closed} +14,
           &quot;Monthly&quot;, {!var_Date_Closed} +30,
           &quot;Quarterly&quot;, {!var_Date_Closed}  +91,
          &quot;Biannual&quot;, {!var_Date_Closed}  +182,
          &quot;Annual&quot;, {!var_Date_Closed}  +365,
          {!var_Date_Closed}+1)
))</expression>
    </formulas>
    <formulas>
        <name>f_Title_Salesforce</name>
        <dataType>String</dataType>
        <expression>IF(TEXT({!$Record.Type__c})=&quot;Weekly SF Export&quot;, 
    &quot;Weekly Export: &quot;&amp; TEXT(MONTH({!f_Due_Date_by_Frequency_Salesforce})) &amp; &quot;/&quot; &amp;  
                                    TEXT(DAY({!f_Due_Date_by_Frequency_Salesforce})) &amp; &quot;/&quot; &amp; 
                                     TEXT(YEAR({!f_Due_Date_by_Frequency_Salesforce})),
    {!$Record.Title__c})</expression>
    </formulas>
    <interviewLabel
  >Ticket - RT AS - Automatically Create Next Ticket for Repeating Tasks {!$Flow.CurrentDateTime}</interviewLabel>
    <label
  >Ticket - RT AS - Automatically Create Next Ticket for Repeating Tasks</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Ticket</name>
        <label>Create Ticket</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <inputReference>var_Ticket_to_Create</inputReference>
    </recordCreates>
    <start>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Assign_Date_Closed</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND 3 AND (4 OR 5)</filterLogic>
        <filters>
            <field>Frequency__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Once</stringValue>
            </value>
        </filters>
        <filters>
            <field>Frequency__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Phase__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Closed</stringValue>
            </value>
        </filters>
        <filters>
            <field>Phase__c</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>CreatedDate</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>Ticket__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>var_Date_Closed</name>
        <dataType>Date</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <elementReference>$Flow.CurrentDate</elementReference>
        </value>
    </variables>
    <variables>
        <name>var_Ticket_to_Create</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Ticket__c</objectType>
    </variables>
</Flow>
